import pandas as pd

# Example: load your dataframe
# df = pd.read_csv("sgh_c_spend_summary.csv")  

result = (
    df.groupby("snapshot_date")
      .agg(
          SPEND=("SPENDS", "sum"),
          debit_active=("SPEND_ACTIVE_TOTAL", lambda x: x.sum() / len(x))
      )
      .reset_index()
      .sort_values("snapshot_date")
)

print(result.head())