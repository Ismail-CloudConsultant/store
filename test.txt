import pandas as pd

# Ensure timestamp conversion
df['Data_Upload_TS'] = pd.to_datetime(df['Data_Upload_TS'], errors='coerce')

# Group and aggregate
result_df = (
    df.groupby([
        'Data_Upload_TS',
        'Source_File',
        'Auth_Month',
        'Card_Type',
        'Final_Decision',
        'Merchant_Country',
        'Transaction_Type',
        'Card_Presence',
        'RECURRING_TRANSACTIONS'
    ], dropna=False)
    .agg({
        'Txn_Count': 'sum',
        'Txn_USD_Amount': 'sum'
    })
    .reset_index()
)