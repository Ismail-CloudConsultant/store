import pandas as pd

# Assuming df is your input DataFrame
df['Final_Decision'] = df['Final_Decision'].astype(str).str.strip()
df['Merchant_Country'] = df['Merchant_Country'].astype(str).str.strip()
df['Card_Presence'] = df['Card_Presence'].astype(str).str.strip()
df['Country'] = df['Source_File'].astype(str).str.strip()

# Parse Auth_Month (e.g., 202407) as a date ending on 28th, then compute last day of month
df['Auth_Month'] = df['Auth_Month'].astype(str)
df['Date'] = pd.to_datetime(df['Auth_Month'] + '28', format='%Y%m%d', errors='coerce') + pd.offsets.MonthEnd(0)

# Group and aggregate
result_df = (
    df.groupby([
        'Final_Decision',
        'Merchant_Country',
        'Card_Presence',
        'Country',
        'Date'
    ], dropna=False)
    .agg({'Txn_Count': 'sum'})
    .reset_index()
)