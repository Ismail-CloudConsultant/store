import pandas as pd

# Assuming df_raw is your original DataFrame
df = df_raw.copy()

# Step 1: Convert data types
df['Data_Upload_TS'] = pd.to_datetime(df['Data_Upload_TS'], errors='coerce')
df['m_mon'] = pd.to_numeric(df['m_mon'], errors='coerce', downcast='integer')
df['n_mob1'] = pd.to_numeric(df['n_mob1'], errors='coerce', downcast='integer')

# Convert other fields to numeric
df['accts'] = pd.to_numeric(df['accts'], errors='coerce', downcast='integer')
df['ever_debit_active'] = pd.to_numeric(df['ever_debit_active'], errors='coerce')
df['ever_stmt_active'] = pd.to_numeric(df['ever_stmt_active'], errors='coerce')
df['ever_activation_flag'] = pd.to_numeric(df['ever_activation_flag'], errors='coerce')

# Step 2: Group and aggregate
grouped = df.groupby([
    'Data_Upload_TS', 'Source_File', 'm_mon', 'n_mob1', 'acq_mon',
    'Acquisition_Channel', 'Customer_Type', 'Product_Code', 'Card_Type'
], dropna=False).agg({
    'accts': 'sum',
    'ever_debit_active': 'sum',
    'ever_stmt_active': 'sum',
    'ever_activation_flag': 'sum'
}).reset_index()